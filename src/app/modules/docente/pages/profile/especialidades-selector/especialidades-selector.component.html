<div class="field mb-12">
  <label for="especialidad" class="label block text-lg font-semibold text-gray-800 mb-2">
    Especialidad
  </label>
  
  <div class="relative">
    <!-- Especialidades seleccionadas como chips -->
    @if (selectedEspecialidades.length > 0) {
      <div class="mb-2">
        <div class="flex flex-wrap">
          @for (especialidadId of selectedEspecialidades; track especialidadId) {
            <span class="tag inline-flex items-center bg-indigo-100 text-indigo-800 text-sm font-medium px-3 py-1 rounded-full mr-2 mb-2">
              {{ getEspecialidadName(especialidadId) }}
              <button type="button" 
                (click)="removeSpecialty(especialidadId)"
                class="ml-2 text-indigo-600 hover:text-indigo-800">
                ×
              </button>
            </span>
          }
        </div>
      </div>
    }

    <!-- Input de búsqueda -->
    <div class="w-full">
      <div class="relative bg-white border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
        <input 
          type="text"
          placeholder="Seleccione especialidades"
          name="especialidades"
          class="w-full py-3 px-4 text-gray-900 border-none focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-lg"
          (click)="toggleDropdown()"
          [(ngModel)]="inputValue"
          (ngModelChange)="onSearchChange($event)" />
        
        <!-- Icono de flecha -->
        <svg class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none"
          xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" 
          aria-hidden="true" width="20" height="20">
          <path fill-rule="evenodd"
            d="M5.23 7.23a1 1 0 011.414 0L10 10.586l3.354-3.353a1 1 0 111.413 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
            clip-rule="evenodd" />
        </svg>
      </div>

      <!-- Dropdown de opciones -->
      @if (dropdownOpen()) {
        <div class="absolute w-full bg-white border border-gray-300 rounded-lg mt-1 max-h-60 overflow-auto shadow-lg z-10">
          <ul>
            @for (especialidad of filteredEspecialidades(); track especialidad.id) {
              <li (click)="toggleEspecialidad(especialidad)"
                class="cursor-pointer py-2 px-4 text-gray-700 hover:bg-indigo-100">
                {{ especialidad.nombre }}
              </li>
            }
          </ul>
        </div>
      }
    </div>
  </div>
  
  <p class="instruction text-sm text-gray-500 mt-2">
    Seleccione una o más especialidades
  </p>
</div>